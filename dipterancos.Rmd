---
title: "antncos"
author: "Zach Brown"
date: "February 26, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

1. Load packages
```{r}
library(tidyverse)
library(RColorBrewer)
library(forcats)
library(lubridate)
library(dbplyr)
```

2. load and wrangle data
```{r}
allsbcoants<- read_csv("newsbcoants.csv")


#make df way less obnoxious
antssimple <-allsbcoants %>%
#selecting columns to keep for data analysis
  select(
    order, family, scientificName, year, month, eventDate, verbatimEventDate, samplingProtocol, habitat, country, stateProvince, county, municipality, decimalLatitude, decimalLongitude, recordedBy, individualCount)%>%
#changing months from numerical value to actual name
  mutate(
    monthname = case_when(
      month == 1 ~ "January",
      month == 2 ~ "February",
      month == 3 ~ "March",
      month == 4 ~ "April",
      month == 5 ~ "May",
      month == 6 ~ "June",
      month == 7 ~ "July",
      month == 8 ~ "August"))%>%
#combining trap types
  mutate(
    samplingProtocolname = case_when(
      samplingProtocol == "Pitfall" ~ "Pitfall Trap",
      samplingProtocol == "Pitfall trap" ~ "Pitfall Trap"))

#sum of all individual ants
sumant <- sum(antssimple$individualCount, na.rm = FALSE)

antsncos<-antssimple %>%
#excluded anything that doesnt have UCSB Arthropod Survey
  filter(recordedBy =="UCSB Arthropod Survey")%>%
#exluded anything that doesn't have a genera level determination
  filter(scientificName !="Formicidae")

#sum of all ants in ncos
sumantncos <- sum(antsncos$individualCount, na.rm = FALSE)

#this is just scientific names and individual count dataframe
antstotalncos<-antsncos %>%
  select(scientificName, individualCount)

#Temnothorax dataframe only
temno<-antstotalncos%>%
  filter(scientificName == "Temnothorax")
#sum of individual Temnothorax
sumtemno<-sum(temno$individualCount)

#L. humile dataframe only
lhumile<-antstotalncos%>%
  filter(scientificName=="Linepithema humile")
#sum of individual L. humile
sumlhumile<-sum(lhumile$individualCount)

#Solenopsis dataframe only
solenopsis<-antstotalncos%>%
  filter(scientificName=="Solenopsis")
#sum of individual Solenopsis
sumsol<-sum(solenopsis$individualCount)

#Monomorium dataframe only
mono<-antstotalncos%>%
  filter(scientificName=="Monomorium")
#sum of individual Monomorium
summono<-sum(mono$individualCount)

#Hypoponera dataframe only
hypo<-antstotalncos%>%
  filter(scientificName=="Hypoponera")
#sum of individual Hypoponera
sumhypo<-sum(hypo$individualCount)

```

3. data exploration
```{r}
#this graph looks nice, needs actual count of L. humile

scinameabund<- ggplot(mutate
                     (antsncos, scientificName = fct_infreq(scientificName))) + 
  geom_bar(
    aes(x = scientificName, fill= scientificName)
    ) +
  labs(x="Scientific Name", y="Number of Individual Occurrences", title = "Ant Abundance Before Restoration") +
  theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank()
        )

scinameabund
########################################################################################
#this graph looks nice, needs to be updated with actual counts for L. humile

traptype <- scinameabund + facet_wrap(~samplingProtocol) +labs(title = "Ants by Sampling Protocol")
traptype

########################################################################################
#months need to be ordered chronologically

yearant <- scinameabund + facet_wrap(~monthname) + labs(title = "Ants by Month")
yearant

#######################################################################################
#Habitats need to be condensed

habant <- scinameabund + facet_wrap(~habitat) + labs(title = "Ant abundance by habitat")
habant

#######################################################################################
```

